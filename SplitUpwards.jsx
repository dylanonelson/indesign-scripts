splitUpwards();/* * Split a story after the selected text frame. The current text frame will * be threaded with the text frames before it, and the following text frame * will become the start of a new story. */function splitUpwards(){  var selection;  //Make certain that user interaction (display of dialogs, etc.) is turned on.  app.scriptPreferences.userInteractionLevel = UserInteractionLevels.interactWithAll;  if (    app.documents.length !== 0      && app.selection.length !== 0      && app.selection[0].constructor.name === 'TextFrame'  ) {    //Get the first item in the selection.    selection = app.selection[0];    splitStoryBefore(selection);  } else {    alert('Select one text frame to run this script.');  }}function splitStoryBefore(frame){  var previousTextFrame,      textFrames = [],      textFrame = frame;  while (textFrame !== null) {    // Duplicate each frame    textFrames.unshift(textFrame.duplicate());    // Loop to previous threaded frame    previousTextFrame = textFrame;    textFrame = textFrame.previousTextFrame;    // Remove original frame’s contents    previousTextFrame.texts.item(0).remove();    // Remove original frame    previousTextFrame.remove();  }  // Re-thread duplicated frames  for (var i = 0; i < textFrames.length - 1; i += 1) {    textFrames[i].nextTextFrame = textFrames[i + 1];  }}